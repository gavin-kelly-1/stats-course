<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=no">
    
    <title>BABS Statistics Course</title>
    
    <link rel="stylesheet" href="reveal/dist/reset.css">
    <link rel="stylesheet" href="reveal/dist/reveal.css">
    <link rel="stylesheet" href="reveal/dist/theme/solarized.css">
    <link rel="stylesheet" href="reveal/plugin/highlight/monokai.css">
    <link rel="stylesheet" href="poll/poll.css">
    <style>
     :root {
	 --fci-red:#e30613;
	 --fci-navy:#4565ad;
	 --fci-blue : #94cef2;
	 --fci-yellow : #ffe70b;
	 --fci-green : #76b82a;
	 --fci-orange : #f7ac6f;
	 --fci-purple:#bc90c1;
	 --fci-blue2 : #bee2e9;
	 --fci-yellow2 : #fff6a7;
	 --fci-green2 : #acd084;
	 --fci-orange2: #ffe7ac,purple2:#fbdbdb;
	 --fci-white : #ffffff;
	 --fci-black : #000000;
	 --fci-grey : #706f6f;
	 --prob-font : Georgia, serif;
     }
     .footer-left {
         position: absolute;
         bottom: -30px;
         left: 0%;
     }
     .footer-right {
         position: absolute;
         bottom: -30px;
         right: 0%;
     }
     .reveal.slide .slides > section, .reveal.slide .slides > section > section {
	 min-height: 100% !important;
	 display: flex !important;
	 flex-direction: column !important;
	 position: absolute !important;
	 top: 0 !important;
     }

     .reveal p {
	 text-align: left; }
     
     .container{
	 display: flex;
	 justify-content: space-between !important;
	 column-gap: 50px;
     }
     .col {
	 flex: 1;
     }

     .twocolumn {
	 display: grid;
	 grid-template-columns: 1fr 2fr;
	 grid-gap: 10px;
	 text-align: left;
     }
     .fragment.current-visible.visible:not(.current-fragment) {
	 display: none;
	 height:0px;
	 line-height: 0px;
	 font-size: 0px;
     }
     .contable {
	 display: grid;
	 grid-template-columns: repeat(4, 1fr);
	 gap: 0 0;
	 padding: 5px;
	 width: 440px;
     }
     
     .contable-square {
	 display: grid;
	 background-color: #fff6a7;
	 border: 1px solid rgba(0, 0, 0, 0.8);
	 width: 110px;
	 height: 110px;
	 align-items: center;
	 justify-items: center;
	 align-content: center;
     }
     
     .contable-head {
	 background-color: transparent;
     }
     .contable-margin {
	 background-color: transparent;
	 border: none;
     }
     

     .cursor-dot, .cursor-dot-outline {
	 pointer-events:none;
	 position:absolute;
	 top:0;
	 left:0;
	 border-radius:50%;
	 opacity:0;
	 transform:translate(-50%,-50%);
	 transition:opacity 0.3s ease-in-out,transform 0.3s ease-in-out;
     }
     .cursor-dot{
	 width:12px;
	 height:12px;
	 background-color:red;
	 z-index:1;
     }
     .no-cursor{
	 cursor:none;
     }
     .no-cursor a,.no-cursor div,.no-cursor span{
	 cursor:none;
     }
    </style>
  </head>
  <body>
    <div class="reveal">
      <div class="slides">

	<!-- excl2  -->
	
	<section style="text-align:center">
	  <h3 data-id="code-title">Statistical Reasoning</h3>
	  <h4>Introduction</h4>
	  <p style="text-align:center">Gavin Kelly - Principal Statistican</p>
	  <p style="text-align:center">biostatistics@crick.ac.uk</p>
	  <p style="text-align:center">Bioinformatics and Biostatistics STP (BABS)</p>
	  <p style="text-align:center">#stp-bioinformatics</p>
	</section>

	<section>
	  <h3>General Approach</h3>
	  <ul >
	    <li class="fragment">No cookbook of <em>"this circumstance ⇒ that test"</em></li>
	    <li class="fragment" style="list-style: none;"> - instead: modelling sources of variation</li>
	    <li class="fragment">Very little maths</li>
	    <li class="fragment">Develop understanding</li>
	    <li class="fragment">Recognise some common traps and fallacies</li>
	    <li class="fragment">Be able to consult with an expert</li>
	    <li class="fragment">Groundwork for future hands-on workshops</li>
	  </ul>
	  <aside class="notes">
	    <p>Statistics is a way of improving your reasoning, not a replacement for thinking</p>
	  </aside>
	</section>
	
	
	<section>
	  <h3>Why</h3>
	  <div>
	    <p><em>
	      A mistake in the operating room can threaten the life of one patient.</em></p>
	    <p><em>
	      A mistake in statistical analysis or interpretation can lead to hundreds of early deaths.</em></p>
	    <p><em>
	      So it is perhaps odd that, while we allow a doctor to conduct surgery only after years of training, we give <del>SPSS</del>&nbsp;PRISM to almost everyone
	    </em></p>
	  </div>
	  <div class="footer-right"><small>Andrew Vickers - Sloan Kettering</small></div>
	  <aside class="notes">
	    <p>There are plenty of courses that put dangerous tools in your hands - I'm here to lessen the risk of your causing damage with them</p>
	  </aside>
	</section>

	<section>
	  <h3>Varied Audience</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1"> Bench-science - just show me how to do t-test, Chi-square</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1"> Omics recipient - how do I get a handle on this vast data</li>
	    <li class="fragment fade-in-then-semi-out"> Translational/Clinical scientist - Randomised Control Trials, Observational Studies</li>
	    <li class="fragment fade-in"> Computational Scientist - I know all this already</li>
	  </ul>
	</section>

	<section>
	  <h3>Course Overview</h3>
	  <div style="text-align: left;">
	    <p class="fragment semi-fade-out" data-fragment-index="1">DESIGN: You need to understand your experiment - treatments, outcomes, and sources and structure of variation</p>
	    <p class="fragment fade-in" data-fragment-index="1">INFERENCE: What approaches are capable of producing the evidence to address your question, from your data</p>
	  </div>
	</section>
	

	
	<section>
	  <h3>(Not) Mathematical Tools and Machine Learning?</h3>
	  <div style="text-align: left;">
	    <p class="fragment semi-fade-out" data-fragment-index="1">Emphasises that data is an incomplete sample of measurements</p>
	    <p class="fragment fade-in-then-semi-out" data-fragment-index="1">of systematically and randomly varying subjects</p>
	    <p class="fragment fade-in-then-semi-out">that come within a scientific context</p>
	    <p class="fragment fade-in">And we want to want to keep a handle on this in our results.</p>
	  </div>
	</section>
	
	
	<section>
	  <h3>Not Just Data Analysis</h3>
	  <p>Problem Elicitation and Goal Formulation</p>
	  <p>Experimental Design</p>
	  <p>Data Analysis</p>
	  <p>Presentation and Communication</p>
	  <div class="footer-right"><small>Ron Kenett - Statistics: A Life Cycle View</small></div>
	</section>
	
	
	<section>
	  <h3>The Three Statistical Products</h3>
	  <dl>
	    <div class="fragment semi-fade-out" data-fragment-index="1">
	      <dt>Description</dt>
	      <dd>Capture the structure of the data by compact visual or numerical summary.</dd>
	    </div>
	    <div class="fragment fade-in-then-semi-out" data-fragment-index="1">
	      <dt>Prediction</dt>
	      <dd>Predict new or future observations via a model of existing data. Estimate associations.</dd>
	    </div>
	    <div class="fragment fade-in">
	      <dt>Explanation</dt>
	      <dd>Testing and quantifying causal relationships.</dd>
	    </div>
	  </dl>
	  <div class="footer-right"><small>Galit Shmueli - To Explain or to Predict</small></div>
	  <aside class="notes">
	    <p>Sometimes all we want to do understand our data via a representation that we can more readily comprehend than from just the raw data.  It's still good to bear in mind some best-practice approaches, even though p-values are off-limits</p>
	    <p>Even without thorough randomisation, we can learn about effect sizes and predict future outcomes of data that conform to the same overall characteristics</p>
	    <p>Despite the truism that correlation≠causation, a properly randomised and analysed dataset can probe causal relations.</p>
	  </aside>
	</section>
	
	<section >
	  <h3>Description <span class="fragment" data-fragment-index="1">vs Association</span></h3>
	  <div class="container">
	    <div class="col">
	      <img src="images/goldacre-table1.png" height="600px" style="margin:0">
	      <div style="font-size:7em;position: absolute;top: 150px;" class="fragment fade-in-then-out" data-fragment-index="0">
		<img src="images/goldacre-table1-zoom.png" height="400px" style="border-width:10px; border-radius:10px; border-color:black; border-style:solid" class="fragment" data-fragment-index="0">
	      </div>
	    </div>
	    <div class="col">
	      <img src="images/goldacre-table2.png" height="600px" style="margin:0" class="fragment" data-fragment-index="1">
	      <div style="font-size:7em;position: absolute;top: 150px;" class="fragment fade-in-then-out" data-fragment-index="2">
		<img src="images/goldacre-table2-zoom.png" height="350px" style="border-width:10px; border-radius:10px; border-color:black; border-style:solid" class="fragment" data-fragment-index="2">
	      </div>
	      <div style="font-size:7em;position: absolute;top: 250px;" class="fragment" data-fragment-index="3">&#10060;</div>
	    </div>
	  </div>
	  <div style="position: absolute;top: 100px;" class="fragment" data-fragment-index="4">
	    <img src="images/goldacre-tweet.png" width="600px" style="border-width:20px; border-radius:20px; border-color:black; border-style:solid">
	  </div>	    
	  <div class="footer-left"><small>Ben Goldacre - OpenSAFELY @ Nature 2020</small></div>
	  <div class="footer-right"><small class="fragment" data-fragment-index="1">Sander Greenland - Table 2 Fallacy</small></div>
	</section>
	
	
	
	<section>
	  <h3>A Modelling approach</h3>
	  <ul style="list-style: none;">
	    <li class="fragment" data-fragment-index="0">Allow for multiple sources of variation:
	      <ul>
		<li class="fragment fade-in-then-semi-out" data-fragment-index="0">Treatment</li>
		<li class="fragment fade-in-then-semi-out" data-fragment-index="1">Confounders that might mask the treatment effect: grade...</li>
		<li class="fragment fade-in-then-semi-out" data-fragment-index="2">Modifiers that might stratify the treatment effect: sex, genotype...</li>
		<li class="fragment fade-in-then-semi-out" data-fragment-index="3">Other independent nuisances: batch, pedigree, patient, sex, cage...</li>
	      </ul>
	    </li>
	    <li class="fragment fade-in" data-fragment-index="0">to affect the outcome.</li>
	    <li class="fragment fade-in" data-fragment-index="4">Estimate the extent of all sources together</li>
	    <li class="fragment fade-in" data-fragment-index="5">and calculate uncertainty, and strength of evidence</li>
	  </ul>
	</section>

	<section data-background-color="#e30613">
	  <p class="r-fit-text" style="color:#fff6a7; font-size:8em;">FAKE DATA</p>
	</section>

	<section>
	  <h3>The simplest case</h3>
	  <p>We have 6 measurements: 12, 15, 20, 50, 65, 90</p>
	  <p>We have 6 labels: C1, C2, C3, T1, T2, T3</p>
	  <p>Two treatments: Treated (T) and Control (C)</p>
	  <p class="fragment fade-in">The truth, the whole truth, and nothing but the truth?</p>
	</section>
	
	<section>
	  <h3>Data Frames</h3>
	  <table >
	    <thead>
	      <tr>
		<th>Name</th>
		<th>Treatment</th>
		<th>Value</th>
	      </tr>
	    </thead>
	    <tbody>
	      <tr><td>C1</td> <td>Control</td> <td>12 </td> </tr>
	      <tr><td>C2</td> <td>Control</td> <td>15</td> </tr>
	      <tr><td>C3</td> <td>Control</td> <td>20</td> </tr>
	      <tr><td>T1</td> <td>Treated</td> <td>50</td> </tr>
	      <tr><td>T2</td> <td>Treated</td> <td>65</td> </tr>
	      <tr><td>T3</td> <td>Treated</td> <td>90</td> </tr>
	    </tbody>
	  </table>
	</section>

	<section><h3>Taking it at face value</h3>
	  <div class="container">
	    <div class="col" style="font-size: 0.7em;">
	      <table >
		<thead>
		  <tr>
		    <th>Name</th>
		    <th>Treatment</th>
		    <th>Value</th>
		  </tr>
		</thead>
		<tbody>
		  <tr><td>C1</td> <td>Control</td> <td>12 </td> </tr>
		  <tr><td>C2</td> <td>Control</td> <td>15</td> </tr>
		  <tr><td>C3</td> <td>Control</td> <td>20</td> </tr>
		  <tr><td>T1</td> <td>Treated</td> <td>50</td> </tr>
		  <tr><td>T2</td> <td>Treated</td> <td>65</td> </tr>
		  <tr><td>T3</td> <td>Treated</td> <td>90</td> </tr>
		</tbody>
	      </table>
	    </div>
	    <div class="col">
	      <img class="fragment" src="r-images/toy-1.png">
	    </div>
	  </div>
	</section>

	<section><h3>Does the name hide information?</h3>
	  <div class="container">
	    <div class="col" style="font-size: 0.7em;">
	      <table >
		<thead>
		  <tr>
		    <th>Name</th>
		    <th>Treatment</th>
		    <th style="color:var(--fci-red);">Label</th>
		    <th>Value</th>
		  </tr>
		</thead>
		<tbody>
		  <tr><td>C1</td> <td>Control</td> <td>1</td> <td>12</td> </tr>
		  <tr><td>C2</td> <td>Control</td> <td>2</td> <td>15</td> </tr>
		  <tr><td>C3</td> <td>Control</td> <td>3</td> <td>20</td> </tr>
		  <tr><td>T1</td> <td>Treated</td> <td>1</td> <td>50</td> </tr>
		  <tr><td>T2</td> <td>Treated</td> <td>2</td> <td>65</td> </tr>
		  <tr><td>T3</td> <td>Treated</td> <td>3</td> <td>90</td> </tr>
		</tbody>
	      </table>
	    </div>
	    <div class="col">
	      <img class="fragment" src="r-images/toy-2.png" height="250px">
	      <img class="fragment" src="r-images/toy-3.png" height="250px">
	    </div>
	  </div>
	</section>

	<section><h3>Is it just a label?</h3>
	  <div class="container">
	    <div class="col" style="font-size: 0.7em;">
	      <table>
		<thead>
		  <tr>
		    <th>Name</th>
		    <th>Treatment</th>
		    <th style="color:var(--fci-red);">Time</th>
		    <th>Value</th>
		  </tr>
		</thead>
		<tbody>
		  <tr><td>C1</td> <td>Control</td> <td>1</td> <td>12</td> </tr>
		  <tr><td>C2</td> <td>Control</td> <td>2</td> <td>15</td> </tr>
		  <tr><td>C3</td> <td>Control</td> <td>3</td> <td>20</td> </tr>
		  <tr><td>T1</td> <td>Treated</td> <td>1</td> <td>50</td> </tr>
		  <tr><td>T2</td> <td>Treated</td> <td>2</td> <td>65</td> </tr>
		  <tr><td>T3</td> <td>Treated</td> <td>3</td> <td>90</td> </tr>
		</tbody>
	      </table>
	    </div>
	    <div>
	      <img class="fragment" src="r-images/toy-4.png">
	    </div>
	  </div>
	</section>

	<section><h3>Really a number?</h3>
	  <div class="container">
	    <div class="col" style="font-size: 0.7em;">
	      <table>
		<thead>
		  <tr>
		    <th>Name</th>
		    <th>Treatment</th>
		    <th style="color:var(--fci-red);">Condition</th>
		    <th>Value</th>
		  </tr>
		</thead>
		<tbody>
		  <tr><td>C1</td> <td>Control</td> <td>1</td> <td>12</td> </tr>
		  <tr><td>C2</td> <td>Control</td> <td>2</td> <td>15</td> </tr>
		  <tr><td>C3</td> <td>Control</td> <td>3</td> <td>20</td> </tr>
		  <tr><td>T1</td> <td>Treated</td> <td>1</td> <td>50</td> </tr>
		  <tr><td>T2</td> <td>Treated</td> <td>2</td> <td>65</td> </tr>
		  <tr><td>T3</td> <td>Treated</td> <td>3</td> <td>90</td> </tr>
		</tbody>
	      </table>
	    </div>
	    <div>
	      <img class="fragment" src="r-images/toy-5.png">
	    </div>
	  </div>
	</section>

	<section>
	  <h3>Is there a 'Difference' !?!</h3>
	  <div class="r-stack">
	    <p class="fragment fade-out" data-fragment-index="0">Nothing going on: Y ~ Constant</p>
	    <p class="fragment fade-in-then-out" data-fragment-index="0">Individuals different: Y ~ Individual</p>
	    <p class="fragment fade-in-then-out" data-fragment-index="1">Treatment has an effect: Y~Treatment</p>
	    <p class="fragment fade-in-then-out" data-fragment-index="2">Time has an effect: Y~Time</p>
	    <p class="fragment fade-in-then-out" data-fragment-index="3">Both effects: Y~Treatment + Time</p>
	    <p class="fragment fade-in-then-out" data-fragment-index="4">Modification: Y~Treatment + Time + Treatment:Time</p>
	    <p class="fragment fade-in-then-out" data-fragment-index="5">Greater within-unit variability</p>
	    <p class="fragment fade-in-then-out" data-fragment-index="6">Greater overall variability</p>
	  </div>
	  <div class="fig-container"
	       data-file="d3-fig/oliver.html">
	    
	  </div>
	</section>
	


	<section>
	  <h3>Recap</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">'Simple questions' can escalate</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Modelling is a unifying strategy</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1" style="list-style: none;"> - Think "sources of variation"</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1" style="list-style: none;"> - Unthinking pre-processing is dangerous</li>
	    <li class="fragment fade-in-then-semi-out">A data-frame is just the beginning to understanding your experiment</li>
	    <li class="fragment fade-in-then-semi-out">It's never too early to think about how to analyse</li>
	    <li class="fragment fade-in">Clarity of research question is fundamental</li>
	  </ul>

	</section>
	
	<section>
	  <p class="r-fit-text" style="font-size:8em;">TERMINOLOGY</p>
	</section>


	
	<section>
	  <h2>Experiment</h2>
	  <p>A study in which the investigator has the scope to apply any of the <u>Treatment</u>s to any <span class="fragment highlight-red"><u>Unit</u></span>, to observe some
	    <u>Response</u>.</p>
	</section>
	
	<section>
	  <section>
	    <h2>Experimental Unit</h2>
	    <p>The independent subdivisions of your subjects that might receive any treatment. Typically we refer to an experiment having a total number of experimental units as 'N'.</p>
	  </section>
	  
	  <section>
	    <h2>Experimental Unit</h2>
	    <p>Might not be the <span style="color:var(--fci-red);">biological unit</span>:</p>
	    <div class="container">
	      <div class="col">
		<ul>
		  <li>Mouse vs Cage</li>
		  <li class="fragment" data-fragment-index="1">Biopsy vs Patient</li>
		  <li class="fragment" data-fragment-index="2">Cell line vs plate</li>
		  <li  class="fragment" data-fragment-index="3">Mouse vs Mouse at 24hrs</li>
		</ul>
	      </div>
	      <div class="col">
		<div class="r-stack">
		  <table class="fragment fade-out" data-fragment-index="1">
		    <thead>
		      <th>Cage</th>
		      <th>Treatment</th>
		    </thead>
		    <tr><td>C1</td><td>Low</td></tr>
		    <tr><td>C1</td><td>Low</td></tr>
		    <tr><td>C2</td><td>Normal</td></tr>
		  </table>

		  <table class="fragment fade-in-then-out" data-fragment-index="1">
		    <thead>
		      <th>Patient</th>
		      <th>Treatment</th>
		    </thead>
		    <tr><td>P1</td><td>Drug A</td></tr>
		    <tr><td>P1</td><td>Drug B</td></tr>
		    <tr><td>P2</td><td>Drug B</td></tr>
		    <tr><td>P2</td><td>Drug A</td></tr>
		  </table>

		  <table class="fragment" data-fragment-index="3">
		    <thead>
		      <th>Mouse</th>
		      <th>Time</th>
		      <th>Treatment</th>
		    </thead>
		    <tr><td>M1</td><td>0</td><td>Control</td></tr>
		    <tr><td>M1</td><td>24hr</td><td>Control</td></tr>
		    <tr><td>M2</td><td>0</td><td>Control</td></tr>
		    <tr><td>M2</td><td>24hr</td><td>Low</td></tr>
		  </table>

		</div>
	      </div>

	      <aside class="notes">
		<p>Context is important. Cage may or may not play a role in treatment. Additionally it have an effect on outcome</p>
		<p>Unit could be smaller than the biological unit depending what the treatment is applied to</p>
		<p>Cell-lines are notoriously ambiguous as to what replication they're providing</p>
		<p>Different experimental setups can change what the experimental unit is</p>
	      </aside>
	    </div>
	  </section>


	  <section>
	    <h2>Experimental Unit</h2>
	    <p>Might not be the unit of <span style="color:var(--fci-red);">evaluation</span>:</p>
	    <ul>
	      <li> Mouse vs Cage </li>
	      <li> Cell vs Plate </li>
	      <li> Gene vs Cell</li>
	    </ul>
	    <p class="fragment">
	      Reminder: Experimental units can be allocated treatment independently of each other
	    </p>
	    <p> class="fragment">
	      If you've got an N of thousands, it's probably the wrong N. "What's the population?"
	    </p>
	    <div class="footer-right"><small>Hulbert - Pseudoreplication</small></div>
	  </section>
	</section>  <!-- Experimental Unit -->


	<section>
	  <section>
	    <h3>Nested Units</h3>
	    <p class="fragment semi-fade-out" data-fragment-index="1">Mice are given the treatment, but tumours are measured</p>
	    <p class="fragment fade-in-then-semi-out" data-fragment-index="1">In this case, we <em>probably</em> care about how a typical tumour within a typical mouse would respond differently depending on if it was given the treatment or not</p>
	    <p><span class="fragment fade-in-then-semi-out">The baseline mouse variability is a nuisance. </span><span class="fragment fade-in-then-semi-out">The variability in response to treatment is the real interest. </span><span class="fragment">What is the role of tumour variability?</span></p>
	  </section>

	  <section>
	    <h3>Considerations/approaches</h3>
	    <ul>
	      <li class="fragment semi-fade-out" data-fragment-index="1">Ignore: strong risk of over-inflating evidence</li>
	      <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Aggregate: feels wasteful</li>
	      <li class="fragment fade-in-then-semi-out">'Account for' mouse: wrong error bars?</li>
	      <li class="fragment fade-in-then-semi-out">Model (hierarchical): Complex, often restricted</li>
	      <li class="fragment">(Re)Design - don't just assume 'more of everything' is best</li>
	    </ul>

	  </section>
	</section>  <!-- nested units -->
	
	<section>
	  <section>
	    <h3>Treatment</h3>
	    <p>A study in which the investigator has the scope to apply any of the <span style="color: #ff2c2d;"><u>Treatment</u></span>s to any <span style="color: #17ff2e;"><u>Unit</u></span>, to observe some <u>Response</u>.</p>
	    <p>(<span style="color: #17ff2e;">Unit</span> = The independent subdivisions of your subjects that might receive any treatment)</p>
	    <p class="fragment">An unambiguously defined qualitative or quantitative intervention</p>
	    <p class="fragment">Equivalent observational concept: "Exposure"</p>
	    <aside class="notes">
	      <p>Quantitative could be a range of doses, or durations...</p>
	      <p>Qualitative could be labels such as placebo, drug1, drug2</p>
	      <p>Could also be semi-quantitative: low, medium, high - tricky</p>
	    </aside>
	  </section>
	  
	  <section>
	    <h3>Single treatment vs Control</h3>
	    <ul>
	      <li>You're not <strong>randomly sampling</strong> from two pre-treated populations!</li>
	      <li class="fragment"><strong>Randomly allocate</strong> units to the treatment arms instead</li>
	      <li class="fragment">Q: How many to allocate? <span class="fragment">A: Enough power!</span> </li>
	    </ul>
	    <table class="fragment">
	      <thead>
		<tr><th>Treatment</th><th>Response</th></tr>
	      </thead>
	      <tbody>
		<tr><td>Ctrl</td><td>?</td></tr>
		<tr><td>Treat</td><td>?</td></tr>
		<tr><td>Treat</td><td>?</td></tr>
		<tr><td>Ctrl</td><td>?</td></tr>
	      </tbody>
	    </table>
	    <aside class="notes">
	      <p>Equivalence of random allocation and random sampling is an act of faith</p>
	      <p>N chosen to reflect the required amount of evidence</p>
	    </aside>
	  </section>

	  <section>
	    <h3>Multiple sub-treatments</h3>
	    <ul>
	      <li class="fragment semi-fade-out" data-fragment-index="1">Drug A, Drug B, ... Drug M</li>
	      <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Placebo vs Drug A, Drug B, ... </li>
	      <li class="fragment fade-in-then-semi-out">Untreated, 2hrs, 4hrs, 12hrs, 24hrs</li>
	      <li class="fragment">0mg, 5mg, 10mg, 12.5mg</li>
	    </ul>
	    <table class="fragment">
	      <thead>
		<tr><th>Treatment</th><th>Response</th></tr>
	      </thead>
	      <tbody>
		<tr><td>Placebo</td><td>?</td></tr>
		<tr><td>Placebo</td><td>?</td></tr>
		<tr><td>Drug A</td><td>?</td></tr>
		<tr><td>Drug B</td><td>?</td></tr>
	      </tbody>
	    </table>
	    <aside class="notes">
	      <p>Interested in all pairwise comparisons => equal numbers</p>
	      <p>Maybe allocate more samples to placebo</p>
	      <p>Does the unit persist - destructive?</p>
	      <p>Is the range and resolution suitable? Dose finding vs Curve fitting</p>
	      <p>'Control' should control for everything irrelevant about the treatment</p>
	    </aside>
	  </section>

	  <section>
	    <h3>Multiple co-treatments</h3>
	    <ul>
	      <li class="fragment semi-fade-out" data-fragment-index="1" >Untreated, Drug A, Drug B, Drug A+B</li>
	      <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Drug A or Ctrl, Induced/Uninduced Cre</li>
	      <li class="fragment fade-in-then-semi-out">WT, two solo knockouts, double knockouts.</li>
	      <li class="fragment fade-in-then-semi-out">Synergistic, antagonistic effects. Non-additive <em>interaction</em>s.</li>
	      <li class="fragment fade-in-then-semi-out">Not only are interactions typically smaller than <em>main</em> effects, they're indirect!</li>
	      <li class="fragment">Flips in direction can mitigate this.</li>
	    </ul>
	    <table class="fragment" style="font-size:0.5em;">
	      <thead>
		<tr><th>Treatment</th><th>Condition</th><th>Response</th></tr>
	      </thead>
	      <tbody>
		<tr><td>Placebo</td><td>WT</td><td>?</td></tr>
		<tr><td>Placebo</td><td>KO</td><td>?</td></tr>
		<tr><td>Drug A</td><td>WT</td><td>?</td></tr>
		<tr><td>Drug A</td><td>KO</td><td>?</td></tr>
	      </tbody>
	    </table>
	    
	    <aside class="notes">
	      <p>If higher order effects are not of interest, then possible to reduce replication</p>
	    </aside>
	  </section>

	  <section>
	    <h3>So many questions</h3>
	    <ul>
	      <li class="fragment semi-fade-out" data-fragment-index="1" >Effect of Treatment, ignoring Condition</li>
	      <li class="fragment fade-in-then-semi-out" data-fragment-index="1">or vice-versa</li>
	      <li class="fragment fade-in-then-semi-out">Effect of Treatment adjusting for Condition</li>
	      <li class="fragment fade-in-then-semi-out">or vice-versa</li>
	      <li class="fragment fade-in-then-semi-out">Effect of Treatment in each Condition &#x26A0;</li>
	      <li class="fragment fade-in-then-semi-out">or vice-versa</li>
	      <li class="fragment fade-in-then-semi-out">Synergistic/Antagonistic effect of Condition on Treatment</li>
	      <li class="fragment">(equivalent to the flipped question)</li>
	    </ul>
	    <aside class="notes">
	      <p>Be aware of the dangers of Venn</p>
	    </aside>
	  </section>
	  
	</section> <!-- Treatment -->

	
	<section>
	  <section>
	    <h3>Outcome</h3>
	    <div class="fragment semi-fade-out" data-fragment-index="1">
	      <p>The post-treatment measurement. Has many aliases:</p>
	      <ul>
		<li>Response variable</li>
		<li>Dependent variable</li>
		<li>Variate</li>
		<li>Y</li>
	      </ul>
	    </div>
	    <p class="fragment fade-in-then-semi-out" data-fragment-index="1">Is the main input to estimating/testing your effect size</p>
	    <p class="fragment fade-in-then-semi-out">You may be recording many variates (multi-variate)</p>
	    <p class="fragment fade-in">You may be recording them on many evaluation units</p>
	    <aside class="notes">
	      <p>Multi-variate e.g: omics; overall and relapse-free survival</p>
	      <p>Many evalulation units = aggregation, or sophisticated methods</p>
	    </aside>
	  </section>
	</section> <!-- Outcome -->
	

	<section>
	  <h3>Draw your Assumptions before your Conclusions<sup><small>&dagger;</small></sup></h3>
	  <img src="images/DAG1.svg" style="background-color:white"  width="500" height="500" >
	  <!--
	       dag {
	       bb="-1,-1,1,1"
	       #		 Covariate [pos="0.000,-0.500"]
	       Environment [pos="0.000,0.500"]
	       Response [outcome,pos="0.500,0.000"]
	       Treatment [exposure,pos="-0.500,0.000"]
	       #		 Covariate -> Response
	       Treatment -> Response
	       }
	  -->
	  <div class="footer-right"><small>&dagger; Miguel Hernan</small></div>
	</section>
	
	<section>
	  <section>
	    <h3>Covariates</h3>
	    <div class="fragment semi-fade-out" data-fragment-index="1">
	      <p>Sources of variation (of outcome, between units) other than the treatment</p>
	      <ul>
		<li>Batch</li>
		<li>Operator</li>
		<li>Sex</li>
		<li>Genetic Background</li>
		<li>Time / Age/ Weight</li>
		<li>Comorbidities</li>
	      </ul>
	    </div>
	    <p class="fragment" data-fragment-index="1">If you haven't randomly allocated them, they're observational</p>
	    <aside class="notes">
	      <p> Record everything - if it has an appreciable effect on treatment, it matters</p>
	      <p> Observational claims are fraught</p>
	    </aside>
	  </section>
	  
	  <section>
	    <h3>Common Misconceptions</h3>
	    <ul>
	      <li class="fragment semi-fade-out" data-fragment-index="1">The data need to be cleansed of these prior to the analysis</li>
	      <li class="fragment fade-in-then-semi-out" data-fragment-index="1">You must have a limited number of them</li>
	      <li class="fragment fade-in-then-semi-out">You can only have quantitative covariates</li>
	      <li class="fragment fade-in-then-semi-out">and they must be linear</li>
	      <li class="fragment fade-in-then-semi-out">You can only have qualitative covariates</li>
	      <li class="fragment fade-in-then-semi-out">They're the same thing as confounders</li>
	      <li class="fragment">They're the same things as treatment</li>
	    </ul>
	  </section>
	  
	  <section>
	    <h3>Dealing with Covariates</h3>
	    <ul>
	      <li class="fragment semi-fade-out" data-fragment-index="1">Controlling - look at only one 'branch'</li>
	      <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Stratified Blocking - modifying the randomisation to balance their effect out</li>
	      <li class="fragment fade-in-then-semi-out">Deliberate confounding</li>
	      <li class="fragment fade-in-then-semi-out">Accounting for - holistically estimating them with the treatment effect. Reduces 'noise'</li>
	      <p class="fragment fade-in-then-semi-out"> <code>fit ← lm(outcome ~ treatment + covariate)</code> Two-Way ANOVA</p>
	      <li class="fragment">Ignoring</li>
	    </ul>
	    <aside class="notes">
	      <p>Compromises external validity: treatment effect
		generalises to other 'branches' people might try? Also
		might go against the 3R's ideal of reducing
		unnecessary wastage</p>
	      <p>Removes the bias that imbalance that might occur by
		simple randomisation. Promotes efficiency, but doesn't necessarily give the
		most precision.</p>
	      <p>If they're just nuisances, design for the minimum number of homogeneous blocks</p>
	      <p>Analytic way of 'normalising' the effect.</p>
	      <p>For colliders, doing otherwise is wrong. But usually risks losing precision</p>
	    </aside>
	    
	  </section>

	  <section>
	    <h3>Unknown, Unmeasured, or unControlled</h3>
	    <p>We can't record everything</p>
	    <p>In a randomised experiment, we can <em>expect</em> things to balance out</p>
	    <p>In an observational study, we need to be so careful</p>
	  </section>
	  
	  <section>
	    <h3>Taxonomy of Causality</h3>
	    <div class="r-stack">
	      <img class="fragment" src="r-images/dag1.png"  width="600" height="600" >
	      <img class="fragment" src="r-images/dag2.png"  width="600" height="600" >
	      <img class="fragment" src="r-images/dag3.png" width="600" height="600" >
	      <img class="fragment" src="r-images/dag-random.png" width="600" height="600" >
	      <img class="fragment" src="r-images/dag-confounder.png" width="600" height="600" >
	      <img class="fragment" src="r-images/dag-mediator.png" width="600" height="600" >
	      <img class="fragment" src="r-images/dag-collider.png" width="600" height="600" >
	      <img class="fragment" src="r-images/dag-complete.png" width="600" height="600" >
	    </div>
	  </section>

	  <section>
	    <h3>Simpson's Paradox - uncontrolled confounding</h3>
	    <div class="r-stack">
	      <img class="fragment" src="r-images/simpsons0.png" width="600" height="600" >
	      <img class="fragment" src="r-images/simpsons1.png" width="600" height="600" >
	      <img class="fragment" src="r-images/simpsons2.png"  width="600" height="600" >
	      <img class="fragment" src="r-images/simpsons3.png"  width="600" height="600" >
	    </div>
	  </section>

	  <section>
	    <h3>Collider/Selection Bias</h3>
	    <ul>
	      <li>Two things are both causes of hospitalisation</li>
	      <li>Selecting on shared outcome can induce false assocation</li>
	    </ul>
	    <div class="r-stack">
	      <img class="fragment" src="r-images/collider1.png"  width="450" height="450" >
	      <img class="fragment" src="r-images/collider2.png" width="450" height="450" >
	      <img class="fragment" src="r-images/collider3.png" width="450" height="450" >
	    </div>
	  </section>
	</section> <!-- Covariates -->

	<section>
	  <h3>Recap</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Have a clear idea of all sources of variation</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Fully describe treatment groups</li>
	    <li class="fragment fade-in-then-semi-out">Balance is efficient, but not <em>always</em> required &#9202;</li>
	    <li class="fragment fade-in-then-semi-out">Be really clear on your experimental unit (structure)</li>
	    <li class="fragment fade-in-then-semi-out">Optimise and RANDOMLY ALLOCATE your treatments</li>
	    <li class="fragment fade-in-then-semi-out">Design for noise-minimisation &#9202;</li>
	    <li class="fragment fade-in-then-semi-out">Understand the nature of your outcome</li>
	    <li class="fragment fade-in-then-semi-out">Watch out for hidden observational claims</li>
	    <li class="fragment fade-in">Know what your question is!</li>
	  </ul>
	</section>	

	<!-- incl2  -->
	<!-- excl1  -->

	<section style="text-align:center">
	  <h3 data-id="code-title">Statistical Reasoning</h3>
	  <h4>Introduction</h4>
	  <p style="text-align:center">Gavin Kelly - Principal Statistican</p>
	  <p style="text-align:center">biostatistics@crick.ac.uk</p>
	  <p style="text-align:center">Bioinformatics and Biostatistics STP (BABS)</p>
	  <p style="text-align:center">#stp-bioinformatics</p>
	</section>

	<section>
	  <h3> Principles of Good Design</h3>
	  <ul>
	    <li>Clear aims</li>
	    <li>Unbiased</li>
	    <li>Powerful</li>
	    <li>Generalisable</li>
	    <li>Simple</li>
	    <li>Analysable</li>
	  </ul>
	  <aside class="notes">
	    <p>Pre-specified quantitative questions that the experiment is capable of answering.</p>
	    <p>Avoid systematic mis-estimation of true effect due to mistakes in design, conduct or analysis</p>
	    <p>Enough replication and precision to discriminate between noise and signal</p>
	    <p>Results hold not just for your data, but for a well defined target population</p>
	    <p>The more complex an experiment, the more likely assumptions will break or mistakes will be made</p>
	    <p>Set off with some idea of how you will analyse the data</p>
	  </aside>
	</section>
	
	<section>
	  <h3>Samples</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">You can't measure the effect of unethical treatments in humans</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Nor the effect in all black 6 mice</li>
	    <li class="fragment fade-in-then-semi-out">Even just those at the Crick</li>
	    <li class="fragment fade-in-then-semi-out ">So a sufficient subset will have to do</li>
	    <li class="fragment fade-in">A truly random one is the best guard against selection bias</li>
	  </ul>
	</section>
	
	<section>
	  <h3>Random Sampling</h3>
	  <div class="container">
	    <div class="col">
	      <img src="r-images/populations.png">
	    </div>
	    <div class="col">
	      <img class="fragment" src="r-images/sub-populations.png">
	    </div>
	  </div>
	</section>
	
	<section>
	  <h3>Refresher on data-frames</h3>
	  <ul>
	    <li> Outcome, Treatment and Covariates are all Variables</li>
	    <li class="fragment"> Each unit is observed and all the variables are recorded (in a 'data frame')</li>
	    <li class="fragment"> Variables come in different 'flavours': Numbers, labels...</li>
	  </ul>
	  <table class="fragment">
	    <thead><tr>
	      <th>A</th>
	      <th>B</th>
	      <th>C</th>
	      <th>D</th>
	      <th>E</th>
	      <th>F</th>
	      <th>G</th>
	      <th>H</th>
	    </tr></thead>
	    <tbody>
	      <tr><td>-1.5</td>   <td>5.7</td>   <td>1</td> <td>87</td> <td>[10,200]</td> <td>0.5</td> <td>Alive</td> <td>Normal</td></tr> 
	      <tr><td>2.3 </td>   <td>4.23</td>  <td>2</td> <td>43</td> <td>[15,20]</td> <td>0.8</td> <td>Dead</td> <td>Tumour</td></tr> 
	      <tr><td>NA </td>   <td>99</td>   <td>2</td> <td>27</td> <td>[18,20]</td> <td>0.12</td> <td>Dead</td> <td>Metastasis</td></tr> 
	    </tbody>
	  </table>
	</section>  

	<section>
	  <h3>Refresher on approach</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1"><span style="color:var(--fci-blue);">Uncertainty</span> from systematic and random variation</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Explanatory (causal) approach: <span style="color:var(--fci-red);">random allocation</span></li>
	    <li class="fragment" data-fragment-index="2">Predictive (associative) approach: interpreting <span style="color: var(--fci-green);">observational parts</span> requires assumptions</li>
	  </ul>
	  <table class="fragment" data-fragment-index="3">
	    <thead class="fragment" data-fragment-index="3">
	      <tr class="fragment" data-fragment-index="3"><th style="color:var(--fci-blue)";>Reads ~ </th><th style="color:var(--fci-red)">Treatment + </th><th style="color:var(--fci-green)">Sex + </th><th>Batch +</th><th>Depth</th></tr>
	    </thead>
	    <tr class="fragment" data-fragment-index="3">
	      <td>107</td><td>treated</td><td>M</td><td>B1</td><td>1.2e6</td>
	    </tr>
	    <tr class="fragment" data-fragment-index="4"><td>124</td><td>ctrl</td><td>F</td><td>B2</td><td>1.2e6</td></tr>
	    <tr class="fragment" data-fragment-index="4"><td>145</td><td>ctrl</td><td>M</td><td>B1</td><td>1.3e6</td></tr>
	    <tr class="fragment" data-fragment-index="4"><td>12</td><td>treated</td><td>F</td><td>B2</td><td>1e5</td></tr>
	  </table>
	</section>

	<section>
	  <h3>Some 'statistics' terminology</h3>
	  <dl>
	    <div class="fragment semi-fade-out" data-fragment-index="1">
	      <dt>A Statistic</dt>
	      <dd>A function of data observed in the <span style="color: #76b82a">sample-set</span> outcomes, e.g. total number of reads aligning to EG1 in control samples</dd>
	    </div>
	    <div class="fragment fade-in-then-semi-out" data-fragment-index="1">
	      <dt>Parameter</dt>
	      <dd>An unknown property of your <span style="color:#e30613">population</span> or data generating process,  e.g. expression level of EG1 in untreated mice</dd>
	    </div>
	    <div class="fragment fade-in" data-fragment-index="2">
	      <dt>Estimator</dt>
	      <dd>A <span style="color: #76b82a">statistic</span> that reflects something about the <span style="color:#e30613">population</span> \(\frac{\text{Reads}_\text{EG1}}{\text{All Reads}}\)</dd>
	    </div>
	  </dl>
	</section>
	
	<section>
	  <h3>Distributions</h3>
	  <p>Outcome is (partially) random - given everything we know
	    about a mouse/participant/tissue/organoid/plate of cells
	    (Unit), we still can't say with certainty what the outcome measurement will
	    be. </p>
	  <p>On an apparently identical (exchangeable) unit.</p>
	</section>
	

	<section>
	  <h3>But what is a distribution?</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Rule to get the probability of observing given values</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Area under curve = probability in the range</li>
	    <li class="fragment fade-in-then-semi-out">Families with 2 primary characteristics: location and spread </li>
	    <div class="r-stack">
	      <div class="fig-container fragment fade-in-then-out" data-file="d3-fig/distribution.html?n=40&p=0.7"></div>
	      <div class="fig-container fragment fade-in-then-out" data-file="d3-fig/distribution.html?n=400&p=0.7"></div>
	      <div class="fig-container fragment fade-in-then-out" data-file="d3-fig/distribution.html?n=400&p=0.5"></div>
	      <div class="fig-container fragment" data-file="d3-fig/distribution.html?n=400&p=0.95"></div>
	    </div>
	  </ul>
	</section>

	<section>
	  <h3>Specifically - Poisson for counts?</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">0,1,2... ('no' prior upper bound)</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Number of tumours per mouse; reads aligning to EG1...</li>
	    <li class="fragment fade-in-then-semi-out">Parametrised by rate (λ, not a whole number)</li>
	    <li class="fragment fade-in-then-semi-out">Equivalently, everything defined by probability of observing no events</li>
	  </ul>
	  <div class="fig-container fragment" data-file="d3-fig/poisson.html?p=3"></div>
	</section>

	<section>
	  <h3>Estimators Revisited</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Estimators typically target (from data) the location (perhaps spread) of some distribution (eg. Poisson), or association between distributions</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Desirable attributes:</li>
	    <ul class="fragment fade-in" data-fragment-index="1">
	      <li class="fragment fade-in-then-semi-out">Average across hypothetical repeats converges on true value</li>
	      <li class="fragment fade-in-then-semi-out">Unlimited replicates would give true value</li>
	      <li class="fragment fade-in-then-semi-out">Hypothetical repeats don't vary too much</li>
	      <li class="fragment fade-in-then-semi-out">Robust to outliers</li>
	    </ul>
	    <li class="fragment fade-in-then-semi-out">Maximise how likely your observed data are; minimise error; be parsimonious...</li>
	  </ul>
	</section>

	<section>
	  <h3>Concrete Examples</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Arithmetic mean ('average')</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Geometric mean (antilog average of log transformed)</li>
	    <li class="fragment fade-in-then-semi-out">Median (robust, 'middle' value)</li>
	    <li class="fragment fade-in-then-semi-out">Trimming, winsorizing &Lt; robust estimation</li>
	    <br>
	    <li class="fragment fade-in-then-semi-out">Variance (on a squared scale)</li>
	    <li class="fragment fade-in-then-semi-out">Standard Deviation (biased)</li>
	    <li class="fragment fade-in-then-semi-out">Median Absolute Deviation (robust)</li>
	    <li class="fragment fade-in" style="text-decoration: line-through">Standard Error (inferential)</li>
	  </ul>
	</section>

	<section>
	  <h3>Estimating (with Maximum Likelihood)</h3>
	  <div class="fig-container" data-file="d3-fig/mle-poisson.html?m=10"></div>
	</section>

	<section>
	  <h3>Sampling Distribution (of the mean)</h3>
	  <div class="fig-container" data-file="d3-fig/sampling-poisson.html?n=10&p=10" id="abc1234"></div>
	</section>

	<section>
	  <h3>Half the number of specimens</h3>
	  <div class="fig-container" data-file="d3-fig/sampling-poisson-stderr.html?n=5&p=10" id="abc12345" data-style="height: 440px;"></div>
	  <div class="r-stack">
	    <p class="fragment current-visible" data-fragment-index="0"></p>
	    <p class="fragment current-visible" data-fragment-index="1"></p>
	    <p class="fragment current-visible" data-fragment-index="2"></p>
	    <p class="fragment current-visible" data-fragment-index="3"></p>
	    <p class="fragment current-visible" data-fragment-index="4"></p>
	    <p class="fragment current-visible" data-fragment-index="5"></p>
	    <p class="fragment current-visible" data-fragment-index="6"></p>
	    <p class="fragment current-visible" data-fragment-index="7">Repeated sampling approx normal.</p>
	    <p class="fragment current-visible" data-fragment-index="8">More spread out than before, but still narrower than individual measurements</p>
	    <p class="fragment current-visible" data-fragment-index="9">In the context of an estimate (11), spread aka Standard Error (±1.5)</p>
	    <!-- <p class="fragment current-visible" data-fragment-index="10">Confidence intervals expected to contain X% of the estimates</p>
		 <p class="fragment current-visible" data-fragment-index="11">CIs and StdErrs often have formulas. Can always simulate.</p> -->
	  </div>
	  
	</section>

	<section>
	  <h3>(Why not Poisson for RNASEQ)</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Poisson has fixed spread for given 'average expression'</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Cells are heterogeneous - different cell types=different &lambda;'s</li>
	    <li class="fragment fade-in-then-semi-out">This extra source of variability leads to 'overdispersion'</li>
	    <li class="fragment fade-in-then-semi-out">'Negative Binomial' is an (unhelpfully named?) generalisation</li>
	    <li class="fragment">(Same effect, different standard errors - but Poisson can be fixed)</li>
	  </ul>
	</section>
	<section>
	  <h3>Confidence Intervals</h3>
	  <p> A procedure that works 95% of the time - just as misinterpretable as p-values are</p>
	  <div class="fig-container" data-file="d3-fig/sampling-confint.html?n=5&p=10" id="abc12345" data-style="height: 440px;"></div>
	</section>

	<section>
	  <h3> Recap on estimation</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Your <span style="color: #76b82a">data</span> are random (sample)</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">You're trying to find out something <span style="color:#e30613">fixed but unknown</span> (population)</li>
	    <li class="fragment fade-in-then-semi-out">A summary statistic (estimator) calculated from your data inherits your data's stochasticity.</li>
	    <li class="fragment fade-in-then-semi-out">Distributions are families of 'random outcomes' that reflect the 'type' of your data</li>
	    <li class="fragment fade-in-then-semi-out">(Numbers, positives, counts, proportions, coin-flips,...)</li>
	    <li class="fragment fade-in">Most of the time, we want to see if two <span style="color: #76b82a">estimates</span> reflect a difference <span style="color:#e30613">in the population.</span></li>
	  </ul>
	</section>
	
	<section>
	  <h3>P-values</h3>
	  <div class="container">
	    <div class="col">
	      <div class="poll fragment">
		<h3>p=0.03, calculated effect is 2. Which is true:</h3>
		<ul>
		  <li>Probability actual effect>2 or &lt; -2 is 3%</li>
		  <li>If there were no effect, 3% of times we'd get a value outside -2&hellip;2 </li>
		  <li>Probability of no change is 3%</li>
		  <li>Probability that it's down to chance is 3%</li>
		  <li data-poll="correct">None of the above</li>
		</ul>
	      </div>
	    </div>
	    <div class="col">
	      <div class="r-stack">
		<img src="r-images/quiz_qr.png">
	      </div>
	    </div>
	  </div>
	</section>

	<section data-background-image="images/princess-bride-you-keep-using-that-word.gif">
	</section>

	<section>
	  <h3>Definition of p-value</h3>
	  <p class="fragment semi-fade-out" data-fragment-index="1">Anyone name a city in the UK they've visited?</p>
	  <blockquote class="fragment fade-in-then-semi-out" data-fragment-index="1">is a city because it was granted City status by the monarch of the United Kingdom</blockquote>
	  <blockquote  class="fragment fade-in-then-semi-out" >The probability of observing the sample data, or more extreme data, assuming the null hypothesis is true</blockquote >
	  <p class="fragment fade-in">Definition vs Interpretation</p>
	</section>
	
	<section>
	  <h3>Reintroduce the t-test</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Unconstrained numeric response, two (randomly allocated) treatment groups</li>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Are the groups' responses different?</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Instead, estimate two numbers. Equivalents: </li>
	    <ul class="fragment fade-in-then-semi-out" data-fragment-index="2">
	      <li> Estimate two group averages (control and treated) and see if their difference is zero, or </li>
	      <li> Estimate one group's average \(\mu_\text{Control}\) and one offset \(\delta_\text{TreatmentEffect}\): is that offset zero?</li>
	      <li> Are two (three/four/...) numbers better than one (ANOVA/LRT)?</li>
	    </ul>
	  </ul>
	</section>


	<section>
	  <h3>t-test</h3>
	  <div class="fig-container" data-file="d3-fig/t-test.html?n=3&p=10" id="abc1234" data-style="height: 440px;"></div>
	  <div class="r-stack">
	    <p class="fragment current-visible" data-fragment-index="0">(Unknown) Control Population</p>
	    <p class="fragment current-visible" data-fragment-index="1">(Unknown) Treated Population</p>
	    <p class="fragment current-visible" data-fragment-index="2">Specimens from Control</p>
	    <p class="fragment current-visible" data-fragment-index="3">Specimens from Treated</p>
	    <p class="fragment current-visible" data-fragment-index="4">Control Mean</p>
	    <p class="fragment current-visible" data-fragment-index="5">Sample Mean</p>
	    <p class="fragment current-visible" data-fragment-index="6">Control relative to Control</p>
	    <p class="fragment current-visible" data-fragment-index="7">Treatment effect (relative to control)</p>
	    <p class="fragment current-visible" data-fragment-index="8"><em>Null</em> sampling distribution (from data, using maths)</p>
	    <p class="fragment current-visible" data-fragment-index="9">Probablity that null data would have exceeded observed</p>
	    <p class="fragment current-visible" data-fragment-index="10">In either direction!</p>
	    <p class="fragment current-visible" data-fragment-index="11">We reject the null hypothesis!</p>
	  </div>
  	</section>

	<section>
	  <h3>P value interpretation</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">A random number depending on your observed data</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">'Low' values: Either my null model (or any of its assumptions) is wrong, or I've been unlucky</li>
	    <li class="fragment fade-in-then-semi-out">Controls your long-term rate of making false positive claims about an effect</li>
	    <li class="fragment fade-in-then-semi-out">High p-values could mean your evidence isn't strong</li>
	    <li class="fragment fade-in-then-semi-out">Confidence intervals are an equivalent way of phrasing uncertainty</li>
	    <li class="fragment">Penalise for one claim based on multiple tests</li>
	    <li class="fragment"><em>Part</em> of the evidence</li>
	  </ul>
	</section>

	<section>
	  <h3>Not just one estimate</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1"><span style="color:var(--fci-blue)">Response</span> ~ <span style="color:var(--fci-red)">Treatment</span></li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1"><span style="color:var(--fci-blue)">Specifically-distributed random variable</span>'s location depends on <span style="color:var(--fci-red)">which treatment group a specimen belongs to</span></li>
	    <li class="fragment fade-in-then-semi-out">For <em>Description</em>, just necessary to estimate location in each group (difference ⮕ biological significance)</li>
	    <li class="fragment fade-in-then-semi-out">For <em>Inference</em>, the location estimates and their difference will 'inherit' a distribution (with a reduced spread c.f. an individual measurement)</li>
	    <li class="fragment fade-in">which enables us to test differences statistically.</li>
	  </ul>
	</section>

	<section>
	  <h3>As complex as you dare</h3>
	  <div class="r-stack">
	    <div class="fragment fade-out" data-fragment-index="1">
	      <p>~ 1 (one estimate)</p>
	      <img  src="r-images/cts1.png"  width="500" height="500">
	    </div>
	    <div class="fragment fade-in-then-out" data-fragment-index="1">
	      <p>~ 1 + Treatment (two estimates)</p>
	      <img  src="r-images/cts2.png"  width="500" height="500">
	    </div>
	    <div class="fragment  fade-in-then-out">
	      <p>~ 1 + Treatment + Time (5 estimates)</p>
	      <img  src="r-images/cts3.png"  width="500" height="500">
	    </div>
	    <div class="fragment  fade-in-then-out">
	      <p>~ 1 + Treatment + Time + Treatment:Time</p>
	      <img  src="r-images/cts4.png"  width="500" height="500">
	    </div>
	    <div class="fragment  fade-in-then-out">
	      <p>~ 1 + Treatment + numeric(Time)</p>
	      <img  src="r-images/cts5.png"  width="500" height="500">
	    </div>
	    <div class="fragment  fade-in-then-out">
	      <p>~ 1 + Treatment * numeric(Time)</p>
	      <img  src="r-images/cts6.png"  width="500" height="500">
	    </div>
	    <div class="fragment  fade-in">
	      <p>~ 1 + Treatment +quadratic(Time)</p>
	      <img  src="r-images/cts7.png"  width="500" height="500">
	    </div>
	  </div>
	</section>
	
	<section data-background-image="images/volcano-eruption_1280.jpg" data-auto-animate>
	  <h3>'P' stands for Princess, not Plot</h3>
	  <img class="fragment fade-in" src="images/Volcano-plot.png"  style="opacity:1; height: 500px; width: auto" />
	</section>

	<section data-background-image="images/volcano-eruption_1280.jpg" data-auto-animate data-auto-animate-easing="ease-in">
	  <img src="images/Volcano-plot.png" width="10" height="10" style="opacity:0.1;" />
	</section>

	<section>
	  <h3>Enough Null - I have a real effect of 200</h3>
	  <div class="fig-container" data-file="d3-fig/power.html"></div>
	</section>
	


	<section>
	  <pre>
	    <code data-line-numbers="1-4|5-7|8-14|15">  mu1 ← 400
  mu2 ← 600
  sigma ← 120

  N ← 4
  alpha ← 0.05

  N_sim ← 100
  for (i in 1:N_sim) {
    data ← generate_random_data(N, mu1, mu2, sigma)
    fit ← model_fit(data, model = ~time, null = ~1)
    pvalues[i] ← fit$p.value
  }

  table(pvalues < alpha)
	    </code>
	  </pre>
	  <p class="fragment">
	    Sometimes (seldom)  maths can calculate this all in one go. But we always need a minimum effect size of interest (change/std.dev)
	  </p>
	</section>

	<section>
	  <h3>(A priori) Power</h3>
	  <ul>
	    <li class="fragment  semi-fade-out" data-fragment-index="1">A property of your design, indicates likely informativeness</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Assuming an (unobservable) real effect magnitude, how often will our design falsify there being no effect</li>
	    <li class="fragment fade-in-then-semi-out">Depends on magnitude, noise, statistical stringency,</li>
	    <li class="fragment fade-in-then-semi-out">and design (= number, allocation and structure of replicates)</li>
	    <li class="fragment fade-in-then-semi-out">and analysis method</li>
	    <li class="fragment fade-in">Just one of several justifications for sample size</li>
	  </ul>
	</section>
	
	<section>
	  <h3>Effect of 200 (33% power)  ⮕ 300</h3>
	  <div class="fig-container" data-file="d3-fig/power2.html"></div>
	</section>

	<section>
	  <h3>4 replicates (33% power)  ⮕ 7</h3>
	  <div class="fig-container" data-file="d3-fig/power3.html"></div>
	</section>

	<section>
	  <h3>StdDev 120 (33% power)  ⮕ 60</h3>
	  <div class="fig-container" data-file="d3-fig/power4.html"></div>
	</section>
	


	<section>
	  <h3>Design for successful inference</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Uncertain data means uncertain conclusions</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">Easiest to find large effects, with good tools, when averaging many &amp; consistent replicates</li>
	    <li class="fragment fade-in-then-semi-out">Power calculation (simulate experiment, or via formula) informative on eventual significance</li>
	    <li class="fragment fade-in-then-semi-out">Randomisation expected to cancel out unmeasured biases <em>in the long run</em></li>
	    <li class="fragment fade-in-then-semi-out">But small N in any <em>individual</em> experiment might not achieve this</li>
	    <li class="fragment"> Can't boost N by repeatedly measuring same unit</li>
	  </ul>
	  
	</section>

	<section>
	  <h3>Missingness</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Completely at random (MCAR)</li>
	    <div class="fragment fade-in-then-semi-out" data-fragment-index="1">Complete cases/ mean imputation</div>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="2">Predictable (MAR)</li>
	    <div class="fragment fade-in-then-semi-out" data-fragment-index="3">Multiple/regression imputation</div>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="4">Structural (MNAR)</li>
	    <div class="fragment fade-in-then-semi-out" data-fragment-index="5">Model the missingness mechanism</div>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="6">Partial (Censored)</li>
	    <div class="fragment fade-in" data-fragment-index="7">Interval/Measurement error analysis</div>
	  </ul>
	</section>
	
	
	<section>
	  <h3>Tens of thousands of ...</h3>
	  <ul>
	    <li class="fragment semi-fade-out" data-fragment-index="1">Omics experiments aren't big data, they're wide data</li>
	    <li class="fragment fade-in-then-semi-out" data-fragment-index="1">The experimental design stays much the same for each gene/protein/metabolite</li>
	    <li class="fragment fade-in-then-semi-out">Most inference is on a one-by-one basis = screening</li>
	    <li class="fragment fade-in-then-semi-out">Exploration mandates the need to compress across features (PCA, UMAP, cluster, ...)</li>
	    <li class="fragment fade-in">But if I'm testing 10,000s, what about false positives</li>
	  </ul>
	</section>

	<section>
	  <div class="r-stack">
	    <img src="images/significant1.png" class="fragment fade-out" data-fragment-index="1" />
	    <img src="images/significant2.png" class="fragment" data-fragment-index="1" />
	    <img src="images/significant3.png" class="fragment"/>
	    <img src="images/significant4.png" class="fragment"/>
	    <img src="images/significant5.png" class="fragment"/>
	    <img src="images/significant6.png" class="fragment"/>
	  </div>
	  <p class="fragment">Multiple tests, fewer claims is PROBLEMATIC</p>
	  <p class="fragment" style="font-size: smaller;">Multiple tests and claims could be <em>honestly enriched</em> with false-positives</p>
	  <p class="fragment" style="font-size: smaller;">FDR a property of the whole list of positives, FWER a property of each positive</p>
	</section>


	<section style="font-size:0.8em">
	  <h3>Recap - modelling</h3>
	  <p class="fragment semi-fade-out" data-fragment-index="1">"Be alert to what is importantly wrong" (lack of independence/additivity, missing terms, lost information)</p>
	  <p class="fragment fade-in-then-semi-out" data-fragment-index="1">We can capture complex relations between response and observed sources of variation. Data Frame + model formula</p>
	  <p class="fragment fade-in-then-semi-out">Noisy data = quantifiably uncertain conclusions</p>
	  <p class="fragment fade-in-then-semi-out">Have a clear question, and a design that supports your analysis plan</p>
	  <p class="fragment">Do ask questions</p>
	</section>

	<section style="text-align:center">
	  <h3 data-id="code-title">Statistical Reasoning</h3>
	  <p style="text-align:center">Gavin Kelly - Principal Statistican</p>
	  <p style="text-align:center">biostatistics@crick.ac.uk</p>
	  <p style="text-align:center">Bioinformatics and Biostatistics STP (BABS)</p>
	  <p style="text-align:center">#stp-bioinformatics</p>
	</section>



	<!-- incl1  -->
	<!-- incl2  -->

	<!--  SPARE SLIDES NOT YET RELOCATED FROM YEAR 1 to YEAR 2 
	     
	     <section>
	     <h2>What are we measuring</h2>
	     <ul>
	     <li class="fragment semi-fade-out" data-fragment-index="0">It's so tempting to say we have an N=9000+8000+...</li>
	     <li class="fragment fade-in-then-semi-out" data-fragment-index="0">The treatment is acting on the plate of cells</li>
	     <li class="fragment fade-in-then-semi-out">N=thousands only if we could independently apply treatment to individual cells.</li>
	     <li class="fragment fade-in-then-semi-out">Realistically we have 3+2+2 measurements between 0 and 1</li>
	     <li class="fragment fade-in">Can that be a 'normally distributed' outcome?</li>
	     </ul>
	     </section>

	     <section>
	     <div class="container">
	     <div style="flex:2;">
	     <div class="fig-container" data-file="d3-fig/plate.html"></div>
	     </div>
	     <div style="flex:1;">
	     <ul>
	     <li class="fragment">When p≈0.5, Y=491<span class="fragment">, 527<span class="fragment"> ,494~Normal</span></span></li>
	     <li class="fragment">When p≈0, Y=10<span class="fragment">, 7~Log</span></li>
	     <li class="fragment">When p≈1, Y=994<span class="fragment">, 984 </span></li>
	     <li class="fragment">Small Cells 505</li>
	     <li class="fragment">Large Cells 495</li>
	     </ul>
	     </div>
	     </div>
	     </section>

	     <section>
	     <h3>Generic approaches to Proportions</h3>
	     <ul>
	     <li class="fragment"><del>Pool everything and pretend it's binomial</del></li>
	     <li class="fragment">Pretend it's Normally distributed (unlikely to hold near the extremes)</li>
	     <li class="fragment">Transform to 'more normal' (log, logit)</li>
	     <li class="fragment">Beta regression</li>
	     <li class="fragment">Non-parametric - shuffle the labels</li>
	     </ul>
	     <p class="fragment">Important because Power Calculation depends on analysis method</p>
	     <aside class="notes">
	     <p>The replicate-replicate variability is different order of magnitude to sampling 'error'</p>
	     <p>Variability in treatment, unobserved cell mixtures, ...</p>
	     <p>Important to capture the variability that an independent replication would encounter</p>
	     <p>Power is the probability an experimental and analysis will succeed, <b>assuming that there's something worthwhile finding</b></p>
	     </aside>
	     </section>
	     
	-->
	
	    </div>
	    
	  </div>
	  


	  <script src="jquery/jquery-3.6.1.min.js"></script>
	  <script src="reveal/dist/reveal.js"></script>
	  <script src="reveal/plugin/notes/notes.js"></script>
	  <script src="reveal/plugin/markdown/markdown.js"></script>
	  <script src="reveal/plugin/highlight/highlight.js"></script>
	  <script src="reveal/plugin/reveald3.js"></script>
	  <script src="reveal/plugin/math/math.js"></script>
	  <script src="reveal/plugin/pointer.js"></script>
	  <script src="reveal/plugin/pointer-bubble.js"></script>
	  <script>
	   Reveal.initialize({
	       slideNumber: true,
	       width: 960,
	       height: 700,
	       keyboard: {
		   49: function() {Reveal.slide( 0 )},
		   50: function() {Reveal.slide( 18 )},
		   51: function() {Reveal.slide( 41 )},
		   52: function() {Reveal.slide( 69 )},
		   87: makeSlideBubbleMouse
	       },
	       dependencies: [
		   { src: 'reveal/plugin/poll.js', async: true }
	       ],
	       hash: true,
	       center: false,
	       navigationMode: 'linear',
	       //	 showNotes: "separate-page",
	       pdfSeparateFragments: false,
	       pointer: {
		   key: "q", // key to enable pointer, default "q", not case-sensitive
		   color: "red", // color of a cursor, default "red" any valid CSS color
		   opacity: 0.7, // opacity of cursor, default 0.8
		   pointerSize: 40, // pointer size in px, default 12
		   alwaysVisible: false, // should pointer mode be always visible? default "false"
		   tailLength: 10 // NOT IMPLEMENTED YET!!! how long the "tail" should be? default 10
	       },
	       // Learn about plugins: https://revealjs.com/plugins/
	       plugins: [RevealNotes, RevealMarkdown, RevealHighlight,  Reveald3,  RevealMath.KaTeX,  RevealPointer ]
	   });
	   /* Reveal.on( 'fragmentshown', makeSlideBubbleMouse);
	    * Reveal.on( 'slidetransitionend', makeSlideBubbleMouse); */
	  </script>
  </body>
</html>

